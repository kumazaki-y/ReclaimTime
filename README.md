# Task-Memo

スキル向上を目的にポートフォリオとしてタスク管理アプリを作成しました。

シングルページアプリケーション (SPA) として主に下記の構成で作成しています。

- フロントエンドは **TypeScript / React**
- バックエンドは **Ruby on Rails**
- インフラは **Vercel (静的サイト) / AWS(API)**
- モノレポ構成
- バックエンドとフロントエンドの開発環境は両方ともDockerを使用
詳細は後述の「開発環境 (フロントエンド)」「開発環境 (バックエンド)」「本番環境」をご覧ください。

## 目次

- [機能](#機能)
- [開発環境 (フロントエンド)](#開発環境-フロントエンド)
- [開発環境 (バックエンド)](#開発環境-バックエンド)
- [本番環境](#本番環境)
  - [インフラ構成図](#インフラ構成図)
- [ER図](#er図)
- [使用技術 (フロントエンド)](#使用技術-フロントエンド)
- [使用技術 (バックエンド)](#使用技術-バックエンド)
- [使用技術 (その他)](#使用技術-その他)
- [画面](#画面)

## 画面

- ホーム
- ログイン
- ユーザー登録
- メールアドレス認証
  - 認証確認通知
  - 認証用メール
  - 未認証警告+再送信ボタン
- パスワードリセット
  - 再設定リクエスト
  - 再設定用メール
  - 再設定画面
- ボードCRUD
- タスクCRUD
- 検索
- 絞り込み
- 並び替え

## 機能

### 認証
- ユーザー登録
- メールアドレス認証
  - 認証メール再送信
  - 未認証ユーザー削除 (定期処理)
- ログイン / ログアウト
  - Cookie / セッション
- ゲストユーザーログイン
- パスワードリセット
  - リセットメール認証

### タスク管理
- 作成 / 表示 / 更新 / 削除
- ボード（タスクグループ） 作成 / 表示 / 更新 / 削除
- タスク(各ボードに紐づく) 作成 / 表示 / 更新 / 削除
- 検索
- 絞り込み
- 並び替え    
  - ドラッグ&ドロップ  
  - 状態保持
- ページネーション

## 開発環境 (フロントエンド)
フロントエンドにはTypeScriptとReactを採用しています。

TypeScriptを使用することで型安全性が強化され、開発効率とコードの可読性が向上しています。

ビルドツールにはViteを使用しており、迅速なビルドとホットリロードによって開発体験が快適になります。

実行環境のバージョン:

- Vite: 5.4.8
- Yarn: 1.22.22
- Node.js: v20.16.0
- TypeScript: 5.6.2
- React: 18
ブラウザにはChrome (Mac) を使用しています。

## 開発環境 (バックエンド)

バックエンドにはRuby on Railsを使用して、以下の構成で統合開発環境を整えています。

メール送信にはActionMailerを使用し、自分が所有しているgmailから送信テストを実行。

- Ruby (3.3.4)
- Ruby on Rails (7.1.3.4)
- MySQL (8.0.40)


## 本番環境

フロントエンドで生成された静的ファイルのホスティングには、Vercelを採用しました。

バックエンドAPIの実行にはAWSを利用しています。

各サービスの役割は以下の通りです。

- **Vercel**：静的ファイルホスティング
- **VPC**：メインネットワーク範囲を管理 (CIDR: 10.0.0.0/16)
- **IGW**：パブリックサブネット用のインターネットゲートウェイを設定
- **パブリックサブネット**：フロントエンドやロードバランサーなど、外部と通信が必要なリソースを配置
- **ALB (Application Load Balancer)**：外部からのアクセスを管理し、ECSのタスクにリクエストを分散
- **プライベートサブネット**：データベースやアプリケーションサーバーを配置し、外部からのアクセスを制限
- **ECS (Elastic Container Service)**：コンテナオーケストレーションを行い、アプリケーションのデプロイを管理
- **RDS (Aurora MySQL 8.0.3.05.2)**：リレーショナルデータベース (RDB)
- **ECR (Elastic Container Registry)**：アプリケーションのDockerイメージを保存
- **IAM (ユーザー、ロール、ポリシー)**：アクセス管理
- **Amazon SES (SMTPインターフェイス)**：カスタムドメインのメール送信
- **Systems Manager (パラメータストア)**：機密情報の保管
- **Certificate Manager**：SSL/TLS証明書発行 (API用カスタムドメイン)
- **CloudWatch (ログ)**：ログ管理

## インフラ構成図

アプリケーションの基本的な処理の流れは以下の通りです。

1. ユーザーはVercelにデプロイされたフロントエンドアプリケーションのURLからアクセスします。
2. APIが必要なリクエストは、パブリックサブネット内のALB (Application Load Balancer) を通じてバックエンドに送信されます。
3. ALBは、ECS (Elastic Container Service) によって管理されるコンテナ化されたRailsアプリケーションにリクエストを転送します。
4. ECSは、プライベートサブネット上でアプリケーションを実行し、以下のような処理を行います。
   - RDS (Aurora MySQL) へのデータベースアクセス
   - Amazon SESを利用したメール送信
   - CloudWatchにログを送信し、監視・管理を実行

以下の図は、この処理の流れを示しています。


![画像の説明](https://drive.google.com/uc?export=view&id=10K-mME20BSDO5qPM4VSsJ2TaYStWcR43)

インフラは業務での実践を想定し構成しました。

今回のアプリには過剰かもしれない要素もありますが、今後の業務でのインフラ設計や運用に役立つ知識を身につけるために組み込み、実務レベルで評価されるインフラ構成を目指しています。

以下、各ポイントについて説明します。

### ECSとECRの連携
アプリケーションのコンテナイメージは、ECR（Elastic Container Registry）に保存されています。

ECS（Elastic Container Service）は、デプロイ時や更新プロセスで、このECRから最新のDockerイメージを取得し、アプリケーションのコンテナとして実行します。

この構成により、アプリケーションの更新が簡易かつ効率的に行えるため、迅速なデプロイが可能です。

また、ECRを利用することでセキュアにコンテナイメージを管理でき、信頼性の高い環境を構築しています。この流れは、実際の業務での継続的デリバリーを想定して取り入れました。

### ECSからのCloudWatchへのログ送信
ECSは、アプリケーションの動作ログやエラーログをCloudWatchに送信しています。

これにより、エラー発生時の監視やトラブルシューティングが迅速に行えるようになります。

さらに、パフォーマンスのモニタリングやリソース管理にも役立てており、安定したサービス運用が実現できます。

CloudWatchによる監視は、業務での障害対応やパフォーマンス管理に活用することを見越して導入しました。

### ALB（Application Load Balancer）とInternet Gatewayの役割
ALBは、インターネットゲートウェイ（IGW）を通じてユーザーからのリクエストを受け取り、パブリックサブネット内で稼働しています。

ロードバランサーとして、ユーザーからのリクエストをECSに振り分け、スケーラビリティと冗長性を確保しています。

また、HTTPS通信が可能なため、セキュリティを担保したアクセス管理が実現されています。

これは、負荷分散とセキュリティの確保を目指し、実務でのスケーラブルな設計を意識して取り入れました。

### RDSの配置理由とプライベートサブネットのセキュリティ
RDS（Aurora MySQL）は、プライベートサブネット内に配置されています。

この配置により、外部からの直接アクセスが遮断され、データベースのセキュリティが強化されています。

アプリケーションサーバーのECSのみがRDSにアクセスできるよう設定されており、安全なデータ保護が可能です。

このサブネット分離の設計は、業務でのセキュリティを重視したデータ保護を意識して導入しました。

## ER図

![ER図](https://drive.google.com/uc?export=view&id=1wmSFyD00zgSvfsyQ_NJvm8xy4nzcXmDK)

上記のER図は、タスク管理アプリケーションのためのデータベース構造を表しています。

主要なテーブルはusers、boards、tasksの3つで構成され、usersは認証情報を保持し、各ユーザーが作成したタスクの管理をサポートしています。

boardsはタスクをグループ化する単位であり、各boardは一人のユーザーに紐づけられます。

さらに、tasksは具体的なタスクの詳細を管理し、それぞれが特定のboardに所属しています。

このER図の作成には、dbdiagram.ioを使用しました。

このサービスはschema.rbなどの実際のモデル定義を貼り付けるだけでER図を生成します。




